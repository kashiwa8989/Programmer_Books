<div class="container  px-8 px-sm-8">
  <p><span class="bg-lightsecondary">投稿一覧</span>
   <table class="table ">
     <%= form_tag books_path, method: :get, class: 'boards__searchForm' do %>
      <%= select_tag :tag_id,
                     options_from_collection_for_select(Tag.all, :id, :name, params[:tag_id]),
                     {
                       prompt: 'タグで絞り込み検索',
                       onchange: 'submit(this.form);'
                     }
      %>
    <% end %>
    <thead>
      <tr>
        <th>投稿者</th>
        <th>本の名前</th>
        <th>本の画像</th>
        <th>タグ</th>
        <th>コメント件数</th>
        <td>フォロー数</td>
        <td>フォロワー数</td>
        <th></th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <% @books.each do |book| %>
      <tr>
        <th><%= book.user&.name || '名無し' %></th>
        <th><%= link_to book.title, book_path(book.id) %></th>
        <th><% if book.image.attached? %>
            <%= image_tag book.image, size: "200x200" %>
            <% else %>
            <%= image_tag 'no_image', size: "200x200" %>
            <% end %>
        </th>
        <th><%= book.tags.name %></th>
        <th><%= link_to "#{book.book_comments.count} コメント", book_path(book.id) %></th>
        <th><%= book.user.followings.count %></th>
        <th><%= book.user.followers.count %></th>

        <th>
        <% if current_user != book.user%>
        <% if current_user.following?(book.user) %>
        <%= link_to "フォロー外す", user_relationships_path(book.user), method: :delete %>
        <% else %>
        <%= link_to "フォローする", user_relationships_path(book.user), method: :post %>
        <% end %>
        <% end %>
        </th>
      </tr>
        <% end %>
    </tbody>
  </table>
</div>
